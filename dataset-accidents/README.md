# Сообщения о ДПТ из группы "ДТП и ЧП | Санкт-Петербург"

## Сбор данных

Данные взяты из группы ВКонтакте [ДТП и ЧП | Санкт-Петербург](https://vk.com/spb_today) при помощи [*API*](https://vk.com/dev/wall.get)

### Структура поста

```json
{
    "id": 13979013,
    "from_id": -68471405,
    "owner_id": -68471405,
    "date": 1603222583,
    "marked_as_ads": 0,
    "post_type": "post",
    "text": "Паровозик из 4х машин на Пискаревском над Шафировской развязкой.",
    "signer_id": 35464517,
    "attachments": [
       ...
    ],
    "post_source": { "type": "vk" },
    "comments": { "count": 9, "can_post": 1 },
    "likes": { "count": 17, "user_likes": 0, "can_like": 1, "can_publish": 1 },
    "reposts": { "count": 0, "user_reposted": 0 },
    "views": { "count": 27063 }
}
```

### Структура датасета

| key               | type           | description                   |
|:------------------|:---------------|:------------------------------|
| id                | int64          |Id поста                       |
| text              | str            |Текст поста                    |
| date              | datetime64     |Дата публикации                |
| comments          | int64          |Количество комментариев        |
| likes             | int64          |Количество лайков              |
| reposts           | int64          |Количество репостов            |
| views             | int64          |Количество просмотров          |
| attachments_count | int64          |Количество файлов (фото/видео) |


### Пример

|       id | text                                                                                                                                                        |   comments |   likes |   reposts |   views |   attachments_count |
|---------:|:------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------:|--------:|----------:|--------:|--------------------:|
|  1946312 | На съезде с краснопутиловской на площадь победы,тетенька на джетте догнала дядю, занимают крайний правый ряд,не сильно мешают, служб нет                    |          0 |       7 |         0 |       0 |                   0 |
|  6716178 | Просто комбо...как так?две в одну припаркованную машинку...на проспекте Славы 15-13 у пятёрки                                                               |          0 |      57 |         1 |   89189 |                   0 |
|  4970956 | В 2:20 ДТП на перекрёстке Колтушского и Воейковского шоссе, две фуры. ДПС на месте. стоят до сих пор в 6.40                                                 |          0 |      38 |         1 |       0 |                   2 |
|  8993692 | На Ленинском проспекте у перекрестка с проспектом Народного Ополчения. Газель прилегла отдохнуть. Все живы! Водитель газели вылез через пассажирскую дверь! |         25 |      74 |         3 |   84722 |                   0 |
| 13483428 | На перекрёстке проспекта Юрия  Гагарина и Кузнецовской столкнулись Ауди и Рав Таёта.                                                                        |         29 |      27 |         1 |   72689 |                   2 |


## Анализ

Определение поля `location` при помощи библиотеки [natasha](https://natasha.github.io)

### Структура датасета

| key               | type           | description                   |
|:------------------|:---------------|:------------------------------|
| text              | str            |Текст поста                    |
| date              | datetime64     |Дата публикации                |
| comments          | int64          |Количество комментариев        |
| likes             | int64          |Количество лайков              |
| reposts           | int64          |Количество репостов            |
| views             | int64          |Количество просмотров          |
| attachments_count | int64          |Количество файлов (фото/видео) |
| taxi              | bool           |ДТП с такси                    |
| pedestrian        | bool           |ДТП с наездом на пешехода      |
| drunk             | bool           |ДТП с пьяным водителем         |
| carsharing        | bool           |ДТП с каршерингом              |
| location          | object         |Название улицы                 |


### Пример

|       id | text                                                                                                                                                                                              | date                |   comments |   likes |   reposts |   views |   attachments_count | taxi   | pedestrian   | drunk   | carsharing   |   hour | location                                     |
|---------:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------|-----------:|--------:|----------:|--------:|--------------------:|:-------|:-------------|:--------|:-------------|-------:|:---------------------------------------------|
| 11917919 | Не прошло и 61 минуты, как определилась вторая пара полуфиналистов в турнире «устрой дтп на Литейном» напротив Мариинской городской                                                               | 2019-09-21 14:04:05 |         39 |      57 |         1 |   88602 |                   3 | False  | False        | False   | False        |     14 | ['Литейном']                                 |
|          | Сюжет аналогичен: один мчит по рельсам, второй разворачивается со среднего                                                                                                                        |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|  3883823 | На Литейном, все живы, сбили парнишку лет 13                                                                                                                                                      | 2016-05-28 16:21:43 |          0 |      19 |         1 |       0 |                   0 | False  | True         | False   | False        |     16 | ['Литейном']                                 |
| 13754278 | Ищу записи с видеорегистратора, нужен момент дтп на Латышских Стрелков 15к1. Временной интервал 4 сентября с 21:33 до 21:40                                                                       | 2020-09-05 12:01:59 |         41 |      24 |         2 |   71904 |                   6 | False  | False        | False   | True         |     12 |                                              |
|          |                                                                                                                                                                                                   |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | Авария с машиной Форд фокус была до меня!!!                                                                                                                                                       |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          |                                                                                                                                                                                                   |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | Я проезжал мимо аварии на низкой скорости, по своей полосе, на встречу мне двигался автомобиль Mitsubishi Pajero Sport чёрного цвета, он очень торопился проскочить машины, так что притер меня.  |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | И скрылся с места ДТП на скорости.                                                                                                                                                                |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | ****т198 оканчивается номер.                                                                                                                                                                      |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          |                                                                                                                                                                                                   |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | Во все службы обратился. Я водитель каршеринга.                                                                                                                                                   |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|  9822938 | На Витебском прямо передо мной разложился черный Хендай Солярис.                                                                                                                                  | 2018-10-12 22:58:05 |         99 |      56 |         1 |   85736 |                   3 | False  | False        | False   | False        |     22 | ['Витебский прямо', 'Витебский', 'Типанова'] |
|          | Водитель перепутал изгиб Витебского левее со с съездом на Типанова правее с Т образным перекрестком в конце,                                                                                      |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | ДПС подошли сразу же после столкновения, так как находились рядом.                                                                                                                                |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          |                                                                                                                                                                                                   |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | На фото не сильно понятно, но движок практически на асфальте, подушки и руль лежал на коленях.                                                                                                    |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          |                                                                                                                                                                                                   |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|          | На видео попал момент обгона за секунды до ДТП.                                                                                                                                                   |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
|  9175991 | Вечернее ДТП на конной лахте. Один неудачно выехал, другой отправил встречку отдыхать в кювет. Проезд в оба направления только по центру.                                                         | 2018-07-01 20:23:43 |          7 |      42 |         2 |  101529 |                   1 | False  | False        | False   | False        |     20 |                                              |
|  5544729 | Сандеро дал под зад такси перед ст.м.Рыбацкое.                                                                                                                                                    | 2016-12-13 08:57:27 |          0 |      29 |         2 |       0 |                   0 | True   | False        | False   | False        |      8 |                                              |
|  3329527 | Видео вчерашнего ДТП на Парашютной , Водитель Жигулей не смог выровнять машину после быстрого левого поворота 25.03.2016                                                                          | 2016-03-26 12:27:19 |          0 |      39 |         4 |       0 |                   2 | False  | False        | False   | False        |     12 | ['Парашютная']                               |
|          | Автор:Alexey Sencha                                                                                                                                                                               |                     |            |         |           |         |                     |        |              |         |              |        |                                              |
| 10782193 | На Большом Проспекте ПС, около 102 дома Дтп  из 5 машин, видимо, один собрал припаркованных                                                                                                       | 2019-03-24 20:41:45 |         40 |      62 |         2 |  102148 |                   0 | False  | False        | False   | False        |     20 |                                              |
|  1653549 | На ПП сбили пешехода. Пересечение бергольц и обуховской обороны. Пострадавшего занесли в трамвай,  т.к. начался очень сильный дождь.                                                              | 2015-09-05 12:49:09 |          0 |      16 |         1 |       0 |                   0 | False  | True         | False   | False        |     12 |                                              |
| 13834692 | Догонялки на Дунайском перед проспектом Девятого Января. Черная Приора догнал Фольксваген Т5. Там и так всегда проблема на поворот.                                                               | 2020-09-23 09:32:54 |         37 |      47 |         1 |   74580 |                   1 | False  | False        | False   | False        |      9 | ['Дунайском']                                |


## Геолокация

Геокодирование при помощи [Mapbox Geocoding API](https://docs.mapbox.com/api/search/#geocoding)

### Пример

|    | locality                                  |   count |     lng |   lat |
|---:|:------------------------------------------|--------:|--------:|------:|
|  0 | Сенной округ                              |     374 | 30.3167 | 59.95 |
|  1 | округ Смольнинское                        |     214 | 30.3167 | 59.95 |
|  2 | округ Кронверкское                        |     204 | 30.3167 | 59.95 |
|  3 | округ Звездное                            |     181 | 30.3167 | 59.95 |
|  4 | Адмиралтейский округ                      |     162 | 30.3167 | 59.95 |
|  5 | округ Ржевка                              |     158 | 30.3167 | 59.95 |
|  6 | Пушкин                                    |     152 | 30.3167 | 59.95 |
|  7 | Колпино                                   |     141 | 30.3167 | 59.95 |
|  8 | округ Московская застава                  |     135 | 30.3167 | 59.95 |
|  9 | округ Чкаловское                          |     132 | 30.3167 | 59.95 |
| 10 | округ Литейный округ                      |     127 | 30.3167 | 59.95 |
| 11 | округ Дворцовый округ                     |     123 | 30.3167 | 59.95 |
| 12 | округ Финляндский округ                   |     117 | 30.3167 | 59.95 |
| 13 | 65-й муниципальный округ Санкт-Петербурга |     112 | 30.3167 | 59.95 |
| 14 | 75-й муниципальный округ Санкт-Петербурга |     106 | 30.3167 | 59.95 |
| 15 | округ Аптекарский остров                  |     105 | 30.3167 | 59.95 |
| 16 | округ Светлановское                       |     103 | 30.3167 | 59.95 |
| 17 | Шушары                                    |      96 | 30.3167 | 59.95 |
| 18 | округ Волковское                          |      95 | 30.3167 | 59.95 |
| 19 | Парголово                                 |      93 | 30.3167 | 59.95 |
| 20 | округ Введенский                          |      92 | 30.3167 | 59.95 |
| 21 | округ Малая Охта                          |      91 | 30.3167 | 59.95 |
| 22 | округ Сампсониевское                      |      89 | 30.3167 | 59.95 |
| 23 | округ Озеро Долгое                        |      87 | 30.3167 | 59.95 |
| 24 | округ Измайловское                        |      86 | 30.3167 | 59.95 |
| 25 | округ Полюстрово                          |      85 | 30.3167 | 59.95 |
| 27 | округ Лиговка-Ямская                      |      83 | 30.3167 | 59.95 |
| 29 | округ Пороховые                           |      77 | 30.3167 | 59.95 |
| 30 | округ Екатерингофский                     |      76 | 30.3167 | 59.95 |
| 31 | округ Обуховский                          |      73 | 30.3167 | 59.95 |
